<!doctype html>
<head>
<style>
img, video {margin:0;padding:0}
#main { position: absolute; top: 0; left: 0; background-color:#000;}
</style>
</head>

<body>

<div id="main">
</div>
 
<script src="http://code.jquery.com/jquery-latest.min.js"></script>

<script>
var imgs = [
  "images/fish.jpg",
  "images/sweetandsourpork.jpg",
  "images/schezwan-veg-noodles.jpg"
];

var videos = [
  'videos/Kleiber_winter_large.ogv',
  'videos/big_buck_bunny_480p.ogv'
];

function play_video(url) {
  $("#myVideo").show();
  document.getElementById("myVideo").setAttribute("src",url);
  document.getElementById("myVideo").load();
  document.getElementById("myVideo").play();
}

function show_image() {
}

// gen elements
// each page should have 100% screen width and height
var pages = [];
for (var i = 0; i < imgs.length; i++) {
  pages.push($('<img src="' + imgs[i] + '"></img>').appendTo($('#main')));
}

for (var i = 0; i < videos.length; i++) {
  var vpage = $('<video controls class="myVideo" src="' + videos[i] + '"></video>').appendTo('#main');
  pages.push(vpage);
}

$('.myVideo').bind('ended', function() { move(); } );

var w = $(window).width();
var h = $(window).height();
$('#main').css('width', w * (imgs.length + videos.length));
$('img').css('width', w);
$('video').css('width', w);
$('img').css('height', h);
$('video').css('height', h);

var cur_ind = 0;

var move = function() {
  cur_ind++;
  $('#main').animate({'margin-left':-w*cur_ind}, {
    duration: 1000,
    complete: on_move_complete
  });
}

function set_timer() {
  setTimeout(move, 2000);
}

var on_move_complete = function() {
  console.log(cur_ind);
  if (cur_ind > 2) { pages[cur_ind][0].play(); }
  else {  set_timer(); }
  if (cur_ind == pages.length - 1) cur_ind = -1;
}

set_timer();
</script>

</body>
